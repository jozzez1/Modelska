\documentclass[12pt, a4paper]{article}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb, fullpage}

\renewcommand{\r}{
    \ensuremath{\mathbf{r}}
}

\newcommand{\p}{
    \ensuremath{\mathbf{p}}
}

\renewcommand{\L}{
    \ensuremath{\mathcal{L}}
}

\newcommand{\e}{
    \ensuremath{\mathrm{e}}
}

\newcommand{\ee}{
    \ensuremath{\mathbf{e}}
}

\newcommand{\sfrac}[2]{
    \ensuremath{\textstyle{\frac{#1}{#2}}}
}

\newcommand{\Frac}[2]{
    \ensuremath{\displaystyle{\frac{#1}{#2}}}
}

\newcommand{\der}[3][]{
    \ensuremath{ \frac{\partial^{#1} #2}{\partial #3^{#1}} }
}

\newcommand{\pl}{
    \ensuremath{\dot{+}}
}

\renewcommand{\d}{
    \ensuremath{\mathrm{d}}
}

\newcommand{\w}{
    \ensuremath{\omega}
}

\newcommand{\Varphi}{
    \ensuremath{\tilde{\varphi}}
}

\begin{document}

\section{Navodilo}

Razi\v s\v ci prostor kro\v znih orbit planeta okrog dvojne zvezde v pribli\v zku zanemarljive mase
planeta. Koliko parametrov ima model?

\section{Razmislek}

V pribli\v zku zanemarljive mase planeta, je vsa dinamika ki jo potrebujemo vezana na gibanje planeta
v \v casovno odvisnem zunanjem potencialu (ki ga ustvarjata zvezdi) $V_\odot(\r, t)$. Hamiltonian celotnega
sistema je
\begin{equation}
    H = \frac{1}{2}\sum_{k = 1}^N \frac{|\p_k|^2}{m_k} - \frac{\kappa}{4\pi}\sum_{k,\ell}
        \frac{m_k m_\ell}{|\r_k - \r_\ell|},
    \label{hamilton}
\end{equation}
vektorje smo ozna\v cili z mastnim tiskom.

\subsection{Prosti parametri}

Da preverimo \v stevilo prostih parametrov moramo hamiltonko~\eqref{hamilton} pretvoriti v brezdimenzijsko
obliko. Energija se bo \v zal ohranjala samo, kadar upo\v stevamo tudi maso planeta, tako da je ne bomo
zanemarili. Naj bo $m_3$ masa planeta, $m_1$ in $m_2$ pa naj bosta masi zvezde. Definirajmo brezdimenzijski
masi
\begin{equation}
    M_1 \equiv \frac{m_1}{m_3}, \quad M_2 \equiv \frac{m_2}{m_3}.
\end{equation}
Nekaj svobode imamo \v se za to, kako bomo merili dol\v zine. Smiselno je, da bi merili v enotah oddaljenosti
zvezd na za\v cetku, tj. $\rho_0 = |\r_1 (0) - \r_2 (0)|$. Da bomo lahko naredili polno brezdimenzijsko
transformacijo potrebujemo \v se skalo za \v cas. Merili ga bomo v enotah $\tau$, ki je
\[
    \frac{1}{\tau^2} \equiv \frac{\kappa m_3}{4\pi\rho_0^3}.
\]
Hamiltonian se potem glasi
\begin{align*}
    H =& \frac{\rho_0^2}{2 m_3\tau^2} \big(\sfrac{1}{M_1}|\p_1|^2\tau^2/\rho_0^2 + \sfrac{1}{M_2}|\p_2|^2\tau^2/\rho_0^2 +
        |\p_3|^2\tau^2/\rho_0^2\big) -\\
       &- \Frac{\kappa m_3^2}{4\pi\rho_0}\bigg(\Frac{M_1}{|\r_1 - \r_3|/\rho_0} + \Frac{M_2}{|\r_2 - \r_3|/\rho_0} +
        \Frac{M_1 M_2}{|\r_1 - \r_2|/\rho_0}\bigg),
\end{align*}
kjer lahko konstanto $\kappa m_3^2/4\pi\rho_0$ izrazimo s $\tau$ in dobimo $m_3\rho_0^2/\tau^2$.
Sedaj uvedemo brezdimenzijske impulze in brezdimenzijske dol\v zine
\begin{equation}
    \frac{\p}{m_3\rho_0/\tau} \mapsto \p, \quad \frac{\r}{\rho_0} \mapsto \r,
\end{equation}
kar hamiltonian poenostavi v
\begin{align*}
    H =& \frac{m_3\rho_0^2}{2\tau^2} (\sfrac{1}{M_1}|\p_1|^2 + \sfrac{1}{M_2}|\p_2|^2 + |\p_3|^2) -\\
       &- \Frac{m_3\rho_0^2}{\tau^2}\bigg(\Frac{M_1}{|\r_1 - \r_3|} + \Frac{M_2}{|\r_2 - \r_3|} +
        \Frac{M_1 M_2}{|\r_1 - \r_2|}\bigg).
\end{align*}
Kar nam \v se preostana je, da uvedemo brezdimenzijsko transformacijo in energijo merimo v enotah
$m_3\rho_0^2/\tau^2$, tj.
\[
    \frac{\tau^2}{\rho_0^2 m_3}H \mapsto H
\]
in dobimo brezdimenzijski hamiltonian
\begin{equation}
    H = \frac{1}{2}\Big(\sfrac{1}{M_1}|\p_1|^2 + \sfrac{1}{M_2}|\p_2|^2 + |\p_3|^2\Big)
        - \bigg(\Frac{M_1}{|\r_1 - \r_3|} + \Frac{M_2}{|\r_2 - \r_3|} + \Frac{M_1 M_2}{|\r_1 - \r_2|}\bigg).
    \label{brezdim}
\end{equation}
Prosti parametri modela so $M_1$, $M_2$ in pa za\v cetni pogoji, ki jih je $2 \cdot 3d$, kjer je $d$
\v stevilo prostorskih dimenzij, ki so nam na voljo. \v Ce se dr\v zimo vezi, da je oddaljenost med zvezdama
na za\v cetku $1$, imamo en za\v cetni pogoj manj\footnote{Ena\v cba~\eqref{brezdim} velja tudi \v ce je
$\rho_0$ karkoli drugega.}.

Ta hamiltonian je \v cisto splo\v sen za gibanje treh (ne nujno nebesnih) to\v ckastih teles pod vplivom sile
gravitacije. Da bodo zvezde res zvezde, si bomo za zgled vzeli res te\v zak planet, Jupiter, ki je \v se
vedno tiso\v c-krat la\v zji od na\v sega Sonca. Kot smiselna se zato zdi omejitev $M_{1,2} \geq 1000$.
Prav tako je smiselno, da so razdalje med zvezdama na za\v cetku res 1.

\subsection{Pribli\v zek zanemarljive mase planeta}

Hamiltonian~\eqref{brezdim} do sedaj eksaktno ohranja energijo. Vendar vidimo, da bo \v clen v potencialu, ki je
sorazmeren z $M_1 M_2$ bistveno ve\v cji od \v clenov, ki so sorazmerni zgolj z $M_{1,2}$ (mogo\v ce za faktor 1000),
saj sta $M_1$ in $M_2$ vsaj reda velikosti $\mathcal{O}(10^3)$. To pomeni, da planet ne bo bistveno vplival na
spremembo gibalne koli\v cine zvezde,
\begin{equation}
    \d\p_{1,2} = \dot{\p}_{1,2}\ \d t = \{\p_{1,2}, V\}\ \d t \approx
        \Big\{\p_{1,2}, -\sfrac{M_1M_2}{|\r_1 - \r_2|}\Big\}\ \d t
\end{equation}
Prav tako se zvezdi glede na planet premikata zelo po\v casi -- efekt planete bi bil viden \v sele po zelo dolgem
\v casu (po mnogih planetarnih obhodih), saj je sprememba $\r$ ute\v zena z $1/M_{1,2}$. Sprememba koordinat
je
\begin{equation}
    \d \r_{1,2} = \dot{\r}_{1,2}\ \d t = \{\r_{1,2}, T\}\ \d t = \big\{\r_{1,2}, \sfrac{1}{2M_{1,2}}|\p_{1,2}|^2\big\}\ \d t.
\end{equation}
Ker smo pri spremembi gibalne koli\v cine naredili napako, ki je bila reda $\mathcal{O}(10^3)$, je ta napaka sedaj
samo $\mathcal{O}(10^{-6})$, torej smo vpliv planeta upravi\v ceno zanemarili.
\subsubsection{Orbiti zvezd}
Orbiti zvezd, $\r_1(t)$ in $\r_2(t)$, v pribli\v zku zanemarljive mase planeta, lahko izra\v cunamo analiti\v cno brez
uporabe numeri\v cnih orodij. Iz Poissonovih oklepajev dobimo slede\v ce gibalne ena\v cbe:
\begin{align}
    \dot{\r}_{1,2}(t) &= \frac{\p_{1,2}(t)}{M_{1,2}} \\
    \dot{\p}_{1,2}(t) &= \nabla_{1,2} \frac{M_1 M_2}{|\r_1 - \r_2|} = \pm \frac{M_1 M_2}{|\r_1 - \r_2|^3}(\r_2 - \r_1)
    \label{predgibalni}
\end{align}
Da bomo to ena\v cbo lahko re\v sili, bomo uvedli spremenljivki
\begin{align*}
    \r_c &= M_1\r_1 + M_2\r_2, \\
    \r_* &= M_1\r_1 - M_2\r_2,
\end{align*}
kjer je $\r_c$ sorazmeren s te\v zi\v s\v cem dvozvezdnega sistema, $\r_T = \r_c/(M_1 + M_2)$.Vektorja $\r_1$ in $\r_2$
lahko zapi\v semo kot linearni kombinaciji $\r_c$ in $\r_*$,
\begin{align*}
    \r_1 &= \sfrac{1}{2M_1}(\r_c + \r_*) \\
    \r_2 &= \sfrac{1}{2M_2}(\r_c - \r_*).
\end{align*}
Vektorjema $\r_c$ in $\r_*$ ustrezata gibalni koli\v cini $\p_c$ in $\p_*$. Dobimo ju iz gibalnih ena\v cb za $\r_c$
in $\r_*$:
\begin{align}
    \dot{\r}_c &= M_1\dot{\r}_1 + M_2\dot{\r}_2 = M_1\sfrac{\p_1}{M_1} + M_2\sfrac{\p_1}{M_2} = \p_1 + \p_2 = \p_c\ , \\
    \dot{\r}_* &= M_1\dot{\r}_1 - M_2\dot{\r}_2 = M_1\sfrac{\p_1}{M_1} - M_2\sfrac{\p_1}{M_2} = \p_1 - \p_2 = \p_*\ ,
\end{align}
kjer vidimo, da mora biti $\p_c$ konstanta gibanja, \v ce je izpeljava pravilna. Impulza $\p_1$ in $\p_2$ lahko
izrazimo kot
\begin{align}
    \p_1 &= \sfrac{1}{2}(\p_c + \p_*), \notag \\
    \p_2 &= \sfrac{1}{2}(\p_c - \p_*).
\end{align}
To lahko vstavimo v ena\v cbi~\eqref{predgibalni}, vendar moramo za to vedeti \v se kako se zapi\v se $\r_1 - \r_2$
z $\r_c$ in $\r_*$. Velja
\[
    \r_1 - \r_2 = \sfrac{1}{2}\big(\sfrac{1}{M_1} + \sfrac{1}{M_2}\big)\r_* = \r_*/2\mu.
\]
Gibalne ena\v cbe za impulza zvezd lahko sedaj prepi\v semo v
\begin{align*}
    \dot{\p}_1 &= (\dot{\p}_c + \dot{\p}_*)/2 = \frac{M_1M_2}{|\r_*/2\mu|^3}(-\r_*/2\mu)
        = -\frac{4\mu^2 M_1M_2}{|\r_*|^2}\ \hat{\r}_*\ , \\
    \dot{\p}_2 &= (\dot{\p}_c - \dot{\p}_*)/2 = \frac{M_1M_2}{|\r_*/2\mu|^3}\r_*/2\mu
        = \frac{4\mu^2 M_1M_2}{|\r_*|^2}\ \hat{\r}_*\ ,
\end{align*}
kjer je $\hat{\r}_* \equiv \r_*/|\r_*|$ enotski vektor v smeri $\r_*$. \v Ce ti dve ena\v cbi se\v stejemo, nemudoma
dobimo $\dot{\p}_c = 0$, kar smo tudi pri\v cakovali. Nadaljujemo z razliko prej\v snjih ena\v cb, po katerih
dobimo $\dot{\p}_*$,
\begin{equation*}
    \dot{\p}_* = - 8\mu^2\frac{M_1M_2}{|\r_*|^2}\ \hat{\r}_*.
\end{equation*}
Brez izgube splo\v snosti lahko izhodi\v s\v ce sistema postavimo v te\v zi\v s\v ce ob \v casu $t = 0$, tj.
$\r_c (t = 0) = 0$. Lahko si izberemo tudi pravi te\v zi\v s\v cni sistem, tj. $\dot{\r}_c = 0$, kar pomeni
tudi $\p_c = 0$. Za opis gibanja $\r_1$ in $\r_2$ sedaj zado\v s\v ca le $\r_*$, katerega Newtonov zakon je
\begin{equation}
    \ddot{\r}_* = -8\mu^2 \frac{M_1M_2}{|\r_*|^2}\hat{\r}_*\ = - \frac{\alpha}{|\r_*|^2}\hat{\r}_*\ ,
    \label{newton}
\end{equation}
Ta problem je dvo-dimenzionalen (ker je potencial centralen), zaradi simetrije problema se nam ponujajo polarne
koordinate $\r_*(t) = \r_* (r(t), \varphi(t))$. Pri\v celi bomo s prehodom v polarne koordinate:
\begin{equation}
    \ee_\rho = \cos\varphi\ \ee_x + \sin\varphi\ \ee_y, \quad \ee_\varphi = -\rho\sin\varphi\ \ee_x + \rho\cos\varphi\ \ee_y.
\end{equation}
Potem lahko na\v s krajevni vektor prepi\v semo v
\begin{align}
    \r_* &= \rho \cos\varphi\ \ee_x + \rho \sin\varphi\ \ee_y \notag \\
         &= \rho\ \ee_\rho, \\
    \dot{\r}_* &= \dot{\rho}\ee_\rho + \dot{\varphi}\ee_\varphi, \\
    \ddot{\r}_* &= (\ddot{\rho} - \rho\dot{\varphi}^2)\ee_\rho + \bigg(\ddot{\varphi} + 
        2\frac{\dot{\rho}\dot{\varphi}}{\rho}\bigg)\ee_\varphi.
    \label{polarne}
\end{align}
Baza v tem primeru ni normirana ($|\ee_\varphi| \neq 1$), vendar $|\r_*| = \rho$. Zaradi tega dobimo
in $\hat{\r}_* = \r_*/\rho = \ee_\rho$. S procesom "`reverse engineering"'
ena\v cbe~\eqref{newton} lahko zapi\v semo Lagrangeian
\begin{equation*}
    L = \frac{1}{2}|\dot{\r}_*|^2 + \frac{\alpha}{\rho} = \frac{1}{2}(\dot{\rho}^2 + \dot{\varphi}^2\rho^2) +
        \frac{\alpha}{\rho}.
\end{equation*}
Tu $\varphi$ ne nastopa eksplicitno, kar pomeni $\dot{p}_\varphi = 0$ oz. ohranitev vrtilne koli\v cine:
\begin{equation}
    \frac{\d}{\d t}\underbrace{\bigg(\der{L}{\dot{\varphi}}\bigg)}_{= p_\varphi} -
        \underbrace{\der{L}{\varphi}}_{= 0} = 0, \quad p_\varphi = \dot{\varphi}\rho^2,
    \label{vrtilna}
\end{equation}
kar pomeni $\dot{\varphi} = p_\varphi/\rho^2$. Opomba: $\p_* = p_\rho\ee_\rho + p_\varphi\ee_\varphi$. Gibalni zakoni
za $\rho$ so
\begin{align}
    \frac{\d}{\d t}\bigg(\der{L}{\dot{\rho}}\bigg) - \der{L}{\rho} &= 0, \notag \\
    \ddot{\rho} - \dot{\varphi}^2\rho - \bigg(-\frac{\alpha}{\rho^2}\bigg) &= 0, \notag \\
    \ddot{\rho} - \dot{\varphi}^2\rho + \frac{\alpha}{\rho^2} &= 0.
    \label{gibalna}
\end{align}
Ena\v cbo~\eqref{vrtilna} uporabimo za da se znebimo $\varphi$,
\begin{align}
    \frac{\d}{\d t} &= \dot{\varphi}\der{}{\varphi} = \frac{p_\varphi}{\rho^2}\der{}{\varphi}, \\
    \frac{\d^2}{\d t^2} &= \frac{p_\varphi}{\rho^4}\bigg(\der[2]{}{\varphi} - \frac{2}{\rho}\der{\rho}{\varphi}
        \der{}{\varphi}\bigg).
\end{align}
Zmenili se bomo $\partial \bullet/\partial \varphi = \bullet'$, da bo manj pisanja. Ko to vstavimo v
ena\v cbo~\eqref{gibalna} dobimo
\begin{equation}
    \frac{p^2_\varphi}{\rho^4}\bigg(\rho'' - \frac{2}{\rho}(\rho')^2 - \rho\bigg) + \frac{\alpha}{\rho^2} = 0.
    \label{skoraj}
\end{equation}
Uvedemo novo spremenljivko $\rho = 1/u$,
\begin{align}
    \rho' &= -\frac{1}{u^2}u' \notag \\
    \rho'' &= 2\frac{1}{u^3}(u')^2 - \frac{1}{u^2}u''.
\end{align}
Sedaj to vstavimo v ena\v cbo~\eqref{skoraj}, kar nam da izraz
\begin{equation*}
    p^2_\varphi u^4\bigg[2\frac{u'^2}{u^3} - \frac{u''}{u^2} - 2\frac{u'^2}{u^3} - \frac{1}{u}\bigg] + \alpha u^2 = 0,
\end{equation*}
ki pa se pokraj\v sa v
\begin{equation}
    u'' + u - \frac{\alpha}{p^2_\varphi} = 0.
\end{equation}
Re\v sitev te ena\v cbe je seveda elipsa,
\begin{equation}
    \rho(\varphi(t)) = \frac{p_\varphi^2/\alpha}{1 + \varepsilon\cos(\varphi(t))},
\end{equation}
Parameter $\varepsilon$ je ekscentri\v cnost orbite, ki so zaklju\v cene (vezano gibanje) samo za
$0 \leq \varepsilon < 1$. Seveda se bomo omejili samo na take.
Kot $\varphi(t)$ je re\v sitev ena\v cbe
\begin{equation}
    \dot{\varphi} = \frac{\alpha^2}{p_\varphi^3}\big(1 + \varepsilon\cos\varphi\big)^2.
    \label{fi}
\end{equation}
Ena\v cbo~\eqref{fi} lahko re\v simo z integralom
\begin{equation}
    \int_0^{\varphi}\frac{\d \tilde{\varphi}}{\big(1 + \varepsilon\cos\tilde{\varphi}\big)^2} = \frac{\alpha^2}{p_\varphi^3}t.
\end{equation}
Ta integral je tabeliran v matemati\v cnem priro\v cniku, re\v sitev je
\begin{align}
    t\frac{\alpha^2}{p^3_\varphi} &= \bigg[\frac{\varepsilon\sin\varphi}{(\varepsilon^2 - 1)(1 + \varepsilon\cos\varphi)}
            +\frac{1}{1 - \varepsilon^2}\frac{2}{\sqrt{1 - \varepsilon^2}}\arctan\bigg(\frac{(1 - \varepsilon)\tan\varphi/2}
            {\sqrt{1 - \varepsilon^2}}\bigg)\bigg] \notag \\
        &= F(\varphi; \varepsilon).
    \label{fi2}
\end{align}
Kon\v cno lahko sedaj zapi\v semo $\varphi = F^{-1}(t\alpha^2/p^3_\varphi; \varepsilon)$. To moramo ra\v cunati
numeri\v cno, imamo pa to smolo, da je ta funkcija zaradi $\tan\varphi/2$ v funkciji $\arctan(x)$ smiselna samo za
$\varphi \in [-\pi,\pi)$, sicer pa mo\v cno oscilira. Pravilna je kadar $t \in [-T/2, T/2)$, kjer je $T$ \v cas enega
obhoda. Tako bomo \v cas pri ra\v cunanju te ena\v cbe z modulom omejili na ta interval. Vendar pa je ta \v casovni
interval grd -- raje bomo vzeli $t \in [0, T)$, tako da bomo rezultatu pri\v steli $\frac{T\alpha^2}{2p^3_\varphi}$.
Zaradi osebne preference bi tudi $\varphi$ radi merili tako, da $\varphi \in [0, 2\pi)$, zato bomo v ena\v cbi~\eqref{fi2}
krivuljo prestavili v desno za fazo $\pi$, torej $\varphi \mapsto \varphi - \pi$. Tako smo se znebili nezveznosti pri
$\pi$. Sedaj lahko izra\v cunamo \v cas obhoda (oz. periodo). Veljati mora torej
\begin{equation}
    t = \frac{p_\varphi^3}{\alpha^2}\bigg[\frac{\varepsilon\sin(\varphi-\pi)}{(\varepsilon^2 - 1)\big(1 +
        \varepsilon\cos(\varphi - \pi)\big)} +\frac{2}{(1 - \varepsilon^2)^{3/2}}\arctan\bigg(\frac{(1 - \varepsilon)
    \tan\frac{\varphi-\pi}{2}}{\sqrt{1 - \varepsilon^2}}\bigg)\bigg]+\frac{T}{2}
    \label{casovna}
\end{equation}
Obhodni \v cas dolo\v cimo tako, da $t(\varphi = 0) = 0$, oz. $t(\varphi = 2\pi) = T$. To pomeni
\[
    \frac{2}{(1 - \varepsilon^2)^{3/2}}\underbrace{\arctan(-\infty)}_{-\pi/2} = -\frac{T\alpha^2}{2p^3_\varphi},
\]
od koder pa z lahkoto poka\v zemo
\begin{equation}
    T = \frac{2\pi p^3_\varphi}{\alpha^2(1 - \varepsilon^2)^{3/2}}.
    \label{leto}
\end{equation}
\subsubsection{Za\v cetni pogoji}
Da bomo res imeli vezana stanja, mora biti ekscentri\v cnost orbite $\varepsilon \in [0, 1)$. Ta je definirana kot
\[
    \varepsilon = \sqrt{1 + \frac{2Ep_\varphi^2}{\alpha^2}},
\]
kjer je $E$ energija sistema, ki jo lahko izra\v cunamo iz za\v cetnih pogojev zvezd. Ker je razdalja med zvezdama
na za\v cetku $1$, je $\rho = 2\mu$ in $\r_*(t = 0) = 2\mu\ee_x$, oz.:
\begin{equation}
    E = \frac{1}{2}\big(p_\varphi^2 + p_\rho^2\big) - 2M_1M_2
\end{equation}
od koder lahko slepamo, da mora biti
\[
    -\frac{\alpha^2}{2p^2_\varphi} \leq E < 0.
\]
Od tu damo lahko smiselne pogoje za za\v cetni izbiri (da bomo dobili vezana stanja) $p_\varphi$ in $p_\rho$:
\begin{equation}
    4M_1M_2 - p_\varphi^2 - \frac{\alpha}{p^2_\varphi} \leq p^2_\rho < 4M_1M_2 - p^2_\varphi.
\end{equation}
Tu dobimo lepe pogje \v se za $p_\varphi^2$, saj mora biti $p_\rho$ realen,
\begin{equation*}
    4M_1M_2 - p_\varphi^2  -\frac{\alpha}{p^2_\varphi} \geq 0,
\end{equation*}
kar nam da bikvadratno ena\v cbo
\begin{equation*}
    -p_\varphi^4 + p_\varphi^2 \cdot 4M_1M_2 - \alpha \geq 0.
\end{equation*}
O\v citno je, da mora biti $p_\varphi^2$ omejena med ni\v clama in da mora biti vseskozi pozitivna, kar je oboje res
za vse izbire $M_1$ oz. $M_2$:
\begin{equation}
    4M_1M_2\Bigg(1 - \sqrt{\frac{M_1^2 + M_2^2}{(M_1 + M_2)^2}}\Bigg) \leq p_\varphi^2 \leq
        4M_1M_2\Bigg(1 + \sqrt{\frac{M_1^2 + M_2^2}{(M_1 + M_2)^2}}\Bigg),
\end{equation}
vendar pa imamo \v se pogoj na zgornji meji $p_\rho^2$, ki pravi $p_\varphi^2 < 4M_1M_2$, tj. je $p^2_\varphi$ omejen na
interval
\begin{equation}
    4M_1M_2\Bigg(1 - \sqrt{\frac{M_1^2 + M_2^2}{(M_1 + M_2)^2}}\Bigg) \leq p_\varphi^2 < 4M_1M_2.
\end{equation}
Brez izgube splo\v snosti se lahko omejimo samo na pozitivne $p_\varphi$ in $p_\rho$, pri \v cemer dobimo
\begin{align}
    p_\varphi &\in \left[\sqrt{4M_1M_2\left(1 - \textstyle{\sqrt{\frac{M_1^2 + M_2^2}{(M_1 + M_2)^2}}}\right)},
        \sqrt{4M_1M_2}\right) \\
        p_\rho &\in \left[\sqrt{4M_1M_2 - p_\varphi^2 - \alpha/p^2_\varphi},\sqrt{4M_1M_2 - p^2_\varphi}\right)
\end{align}
Z masama $M_1$ in $M_2$ tako enoli\v cno dolo\v cimo za\v cetni $\r_*(0)$, z impulzoma $p_\rho(0)$ in $p_\varphi(0)$ pa
\v se obliko tira, oz. $\p_*(0)$.

\subsubsection{Potencial}
Sedaj smo izra\v cunali vse, kar potrebujemo za izra\v cun "`zunanjega"' potenciala v kateraga vr\v zemo na\v s planet
\begin{equation}
    V_\odot (\r, t) \equiv -\Bigg[\frac{M_1}{\big|\r - \frac{1}{2M_1}\r_*(t)\big|}
        + \frac{M_2}{\big|\r + \frac{1}{2M_2}\r_*(t)\big|}\Bigg].
\end{equation}
Gibalni zakoni za planet so
\begin{align}
    \dot{\r}_3 &= \p_3, \\
    \dot{\p}_3 &= -\nabla_3V_\odot(\r_3, t) = - \frac{M_1}{|\r_{31}(t)|^2}\hat{\r}_{31}(t) -
        \frac{M_2}{|\r_{32}(t)|^2}\hat{\r}_{32}(t).
\end{align}
Nobenega razloga ni, zakaj ne bi obdr\v zali polarnih koordinat \v se za $\r_3$. Naj bo
\begin{equation*}
    \r_3 = \zeta\cos\psi\ \ee_x + \zeta\sin\psi\ \ee_y = \zeta\ \ee_\zeta,
\end{equation*}
kar vrne
\begin{align}
    |\r_{31}|^2 &= \zeta^2 + \frac{1}{4M_1^2}\rho^2 - \frac{1}{M_1}\rho\zeta\cos(\psi - \varphi), \\
    |\r_{32}|^2 &= \zeta^2 + \frac{1}{4M_2^2}\rho^2 + \frac{1}{M_2}\rho\zeta\cos(\psi - \varphi).
\end{align}
Sila na planet je v polarnih koordinatah enaka
\begin{align}
    \dot{\p}_3 &= \frac{\sfrac{1}{2}\rho\ \ee_\rho - M_1\zeta\ \ee_\zeta}{[\zeta^2 + \rho^2/4M_1^2
        - \zeta\rho\cos(\psi - \varphi)/M_1]^{3/2}} \notag \\
        &+ \frac{\sfrac{1}{2}\rho\ \ee_\rho + M_2\zeta\ \ee_\zeta}{[\zeta^2 + \rho^2/4M_2^2
        + \zeta\rho\cos(\psi - \varphi)/M_2]^{3/2}}
    \label{impulz}
\end{align}
V polarnih koordinatah je na\v s vektor spremenljivk enak $\mathbf{x} = (\zeta, \psi, p_\zeta, p_\psi)^T$,
kjer velja $p_\zeta = \dot{\zeta}$ in $p_\psi = \dot{\psi}\zeta^2$. Odvoda gibalnih koli\v cin pa dobimo lahko
iz ena\v cb~\eqref{polarne} in hitro ugotovimo, da moramo ena\v cbo~\eqref{impulz} zgolj projicirati na osi planeta:
\begin{align*}
    \dot{p}_\zeta &= \dot{\p}_3 \cdot \ee_\zeta, \\
    \dot{p}_\psi  &= \dot{\p}_3 \cdot \ee_\psi,
\end{align*}
kjer moramo upo\v stevati $|\ee_\psi|^2 = \zeta^2$ in
\begin{align*}
    \ee_\rho \cdot \ee_\zeta &= \cos(\varphi - \psi) \\
    \ee_\rho \cdot \ee_\psi  &= \zeta\sin(\varphi - \psi) \\
    \ee_\zeta \cdot \ee_\psi &= 0.
\end{align*}
Sedaj lahko iz ena\v cbe~\eqref{impulz} izra\v cunamo $\dot{p}_\psi$ in $\dot{p}_\zeta$:
\begin{align}
    \dot{p}_\zeta &= \frac{\rho}{2}\bigg(\frac{1}{|\r_{31}|^{3/2}} + \frac{1}{|\r_{32}|^{3/2}}\bigg)\cos(\varphi - \psi) -
    \zeta\bigg(\frac{M_1}{|\r_{31}|^{3/2}} - \frac{M_2}{|\r_{32}|^{3/2}}\bigg) \\
    \dot{p}_\psi &= \frac{\zeta\rho}{2}\bigg(\frac{1}{|\r_{31}|^{3/2}} +
        \frac{1}{|\r_{32}|^{3/2}}\bigg)\sin(\varphi - \psi)
\end{align}

\subsection{Numeri\v cna integracija}
Ker sta zvezdi bistveno te\v zji od planeta, pri\v cakujemo da bo $T \gg \tau$, ker je $\tau$ karakteristi\v cni
\v cas obhoda planeta (tj. vsaj za velikostni red natan\v cen). Vpra\v sanje je, kako velik naj bo \v casovni korak
za to integracijo?

Precesija zemlje ima periodo $\sim 10^4$ let in to bomo vzeli za merilo $\tau$: $10^{-4}T \sim \tau$. Planetarno
leto bomo razrezali na $\sim 10^2$ kosov, tj. $\delta t \sim 10^{-6} T$. Velikostni red $T$ lahko napovemo iz
ena\v cbe~\eqref{leto} in iz mej za impulze. Naj bo $\varepsilon \sim 0$ in $p_\varphi^2 = 4M_1M_2$, kar nam da
oceno
\[
    T \sim 2\pi \frac{(4M_1M_2)^3}{\alpha^2} = 2\pi \frac{64M_1^3M_2^3}{64\mu^4M_1^2M_2^2} =
        2\pi\frac{(M_1 + M_2)^4}{M_1^3 M_2^3} \sim 10^{-6}.
\]
Imamo torej dva zanimia procesa, ki se dogajata na dveh zelo razli\v cnih skalah, zato je dobro pose\v ci kar po
Bulirsch-Stoerjevem integratorju, \v casovni korak pa naj bo kar $\delta t \sim 10^{-12}$.

Ker bomo obdr\v zali polarne koordinate bomo re\v sevali slede\v ce ena\v cbe:
\begin{equation}
    \dot{\mathbf{x}} = \begin{bmatrix} \dot{\zeta} \\ \dot{\psi} \\ \dot{p}_\zeta \\ \dot{p}_\psi \end{bmatrix} =
        \begin{bmatrix} p_\zeta \\ p_\psi/\zeta^2 \\ \dot{p}_\zeta \\ \dot{p}_\psi \end{bmatrix} =
        \mathbf{f}(\zeta,\psi,p_\zeta,p_\psi, t).
\end{equation}

\subsubsection{Ra\v cunanje orbit zvezd}
Na vsakem \v casovnem koraku bomo morali re\v siti ena\v cbo~\eqref{casovna}, ki je k sre\v ci monotona. Paziti moramo,
da ne pademo ven iz tega intervala. Ni\v cle lahko u\v cinkovito ra\v cunamo z analiti\v cnim odvodom -- ponujajo se
nam Newtonova, Halleyeva in Baileyeva metoda. Za slednji potrebujemo \v se drugi odvod. Ker velja $\partial t/\partial
\varphi = (\partial \varphi/\partial t)^{-1}$ lahko zapi\v semo
\begin{align}
    \frac{\alpha^2 t'}{p_\varphi^3} = \frac{\alpha^2}{p_\varphi^3} \der{t}{\varphi} &= \frac{1}{[1 +
        \varepsilon\cos(\varphi - \pi)]^2} \\
    \frac{\alpha^2 t''}{p_\varphi^3} = \frac{\alpha^2}{p_\varphi^3} \der[2]{t}{\varphi} &=
        \frac{2\varepsilon\sin(\varphi - \pi)}{[1 + \varepsilon\cos(\varphi - \pi)]^3}
\end{align}
Te lahko izra\v cunamo vnaprej (tj. samo na prvem obhodu zvezd) nato pa vrednosti kli\v cemo z ra\v cunalni\v skega
spomina.

\end{document}
